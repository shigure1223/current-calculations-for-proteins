
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3.2. Atomic stress tensor analysis &#8212; CURP 1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="3.3. Energy flow analysis" href="../eflow_tutorial/" />
    <link rel="prev" title="3.1. General instructions" href="../general_tutorial/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../eflow_tutorial/" title="3.3. Energy flow analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../general_tutorial/" title="3.1. General instructions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../">CURP 1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../tutorials/" accesskey="U"><span class="section-number">3. </span>Tutorials</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.2. </span>Atomic stress tensor analysis</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="atomic-stress-tensor-analysis">
<h1><span class="section-number">3.2. </span>Atomic stress tensor analysis<a class="headerlink" href="#atomic-stress-tensor-analysis" title="Permalink to this headline">¶</a></h1>
<p>CURP performs atomistic stress tensor analysis. According to Hardy’s forluma,
the Cauchy stress tensor of the <em>i</em>th atom is given by:</p>
<a class="reference internal image-reference" href="../_images/stress.png"><img alt="../_images/stress.png" class="align-center" src="../_images/stress.png" style="height: 60px;" /></a>
<p>where <span class="math notranslate nohighlight">\(\Omega_i\)</span> is the volume of atom <span class="math notranslate nohighlight">\(i\)</span>,
<span class="math notranslate nohighlight">\(\boldsymbol{F}_{ij}\)</span> is the pairwise interatomic force
acting on <span class="math notranslate nohighlight">\(i\)</span> from <span class="math notranslate nohighlight">\(j\)</span>,
<span class="math notranslate nohighlight">\(\boldsymbol{r}_{ij}\)</span> is the relative displacement vector
from atom <span class="math notranslate nohighlight">\(j\)</span> to atom <span class="math notranslate nohighlight">\(i\)</span>,
<span class="math notranslate nohighlight">\(m_i\)</span>  is the mass of atom <span class="math notranslate nohighlight">\(i\)</span>, and
<span class="math notranslate nohighlight">\(\boldsymbol{v}_i\)</span> is the velocity vector of atom <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>As can be seen from the above formula, the atomic stress tensor of atom <span class="math notranslate nohighlight">\(i\)</span> depends on both the
position and the velocity trajectories during the MD simulations.</p>
<p>The calculation procedure consists of the following steps:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#obtaining-the-md-trajectory" id="id1">Obtaining the MD trajectory</a></p></li>
<li><p><a class="reference internal" href="#stress-tensor-calculation" id="id2">Stress tensor calculation</a></p></li>
<li><p><a class="reference internal" href="#analysis-of-stress-tensor" id="id3">Analysis of stress tensor</a></p></li>
</ul>
</div>
<section id="obtaining-the-md-trajectory">
<h2><a class="toc-backref" href="#id1"><span class="section-number">3.2.1. </span>Obtaining the MD trajectory</a><a class="headerlink" href="#obtaining-the-md-trajectory" title="Permalink to this headline">¶</a></h2>
<p>We show two examples of calculations for <strong>ALA-ALA-ALA in vacuum/solvent</strong>.
NVT MD simulations were performed using the Amber12 program with the time step
of 0.5 fs at room temperature. In addition to the trajectory files,
a parameter topology file is required for each system.</p>
</section>
<section id="stress-tensor-calculation">
<h2><a class="toc-backref" href="#id2"><span class="section-number">3.2.2. </span>Stress tensor calculation</a><a class="headerlink" href="#stress-tensor-calculation" title="Permalink to this headline">¶</a></h2>
<p>Examples for the alanine tripeptide in the vacuum and solvent environments
are found in the directories <code class="docutils literal notranslate"><span class="pre">ala3invac-stress</span></code> and <code class="docutils literal notranslate"><span class="pre">ala3insol-stress</span></code>,
respectively.
Each directory contains three subdirectories named (1) united, (2) residue and (3) whole.</p>
<p>In practice, it is possible to calculate atomic stress tensors for all atoms including the hydrogen atoms, and CURP considiers all atoms in the calculations. However, the all-atom representation is often inconvenient for the stress tensor analysis because the values of the atomic volume obtained by the Voronoi tessellation are sometimes quite small for the hydrogen atoms, leading to large and significant fluctuations.
To overcome this issue, a united-atom approach has been employed.</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}_{J} =
   \frac{1}{{{\Omega _J}}}\sum\limits_{i \in J}
   {\left( {\frac{1}{2}\sum\limits_{k \ne i}
   {{{\boldsymbol{F}}_{{\boldsymbol{ik}}}} \otimes {{\boldsymbol{r}}_{{\boldsymbol{ik}}}}} }
   \right)}\]</div>
<p>,where <span class="math notranslate nohighlight">\(J\)</span> represents a group of atoms. Here, each unit of the atom group could be either (1) united atom (heavy atom together with the attached hydrogen) or (2) amino acid residue, or (3) the whole molecule.</p>
<section id="running-the-program">
<h3>Running the program<a class="headerlink" href="#running-the-program" title="Permalink to this headline">¶</a></h3>
<p>First, change the directory to the working directory for the stress tensor analysis.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> tutorial/ala3invac-stress/united
</pre></div>
</div>
<p>To start the calculations, type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curp compute run.cfg &gt; log
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">run.cfg</span></code> (see below for details) is the configuration file
for the analysis. An alternative way is to run the following script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./run.sh
</pre></div>
</div>
<p>The calculations will be completed shortly and the prompt will appear at the shell.
The results are stored in the files in two forms: (1) <code class="docutils literal notranslate"><span class="pre">stress_atm_dat00000</span></code>:
individual stress tensors for every atom, (2) <code class="docutils literal notranslate"><span class="pre">stress_grp_dat00000</span></code>:
averaged stress tensors for each group, where a group can be either united atom, residue, or the whole molecule.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following lines appear at the bottom of the log file.
<strong>Detailed timing in calculator object</strong>,
<strong>Detailed timing for parallel prossing</strong>,
<strong>The summary of the elapsed times</strong>
The timging information is currently incorrect. Please ignore these lines for now.</p>
</div>
</section>
<section id="setting-run-cfg">
<h3>Setting run.cfg<a class="headerlink" href="#setting-run-cfg" title="Permalink to this headline">¶</a></h3>
<p>An example of <cite>run.cfg</cite> is shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">input</span><span class="p">]</span>
<span class="nb">format</span> <span class="o">=</span> <span class="n">amber</span>
<span class="n">first_last_interval</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">200</span> <span class="mi">1</span>
<span class="c1"># group_file = group.ndx</span>

<span class="p">[</span><span class="n">input_amber</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">trajectory</span>
<span class="n">topology_file</span> <span class="o">=</span> <span class="o">../</span><span class="n">system</span><span class="o">.</span><span class="n">prmtop</span>
<span class="n">coordinate_format</span> <span class="o">=</span> <span class="n">ascii</span>
<span class="n">coordinate_file</span> <span class="o">=</span> <span class="o">../</span><span class="n">sam</span><span class="o">.</span><span class="n">mdcrd</span><span class="o">.</span><span class="n">gz</span>
<span class="n">velocity_format</span> <span class="o">=</span> <span class="n">ascii</span>
<span class="n">velocity_file</span> <span class="o">=</span> <span class="o">../</span><span class="n">sam</span><span class="o">.</span><span class="n">mdvel</span><span class="o">.</span><span class="n">gz</span>

<span class="p">[</span><span class="n">volume</span><span class="p">]</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">voronoi</span>
<span class="n">output_volume_file</span>  <span class="o">=</span> <span class="n">outdata</span><span class="o">/</span><span class="n">volumes</span><span class="o">.</span><span class="n">dat</span>
<span class="n">output_gvolume_file</span> <span class="o">=</span> <span class="n">outdata</span><span class="o">/</span><span class="n">gvolumes</span><span class="o">.</span><span class="n">dat</span>
<span class="n">voronoi_cutoff</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">voronoi_no_hydrogen</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">voronoi_solvation</span> <span class="o">=</span> <span class="n">RANDOM20</span>
<span class="n">voronoi_probe_length</span> <span class="o">=</span> <span class="mf">2.8</span>
<span class="c1"># voronoi_output_solvation_file = outdata/solvated.pdb</span>

<span class="p">[</span><span class="n">curp</span><span class="p">]</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">amber99</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">momentum</span><span class="o">-</span><span class="n">current</span>

<span class="n">group_method</span> <span class="o">=</span> <span class="n">united</span>
<span class="n">decomp_group_current</span> <span class="o">=</span> <span class="n">no</span>
<span class="n">target_atoms</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="mi">33</span>

<span class="n">remove_trans</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">remove_rotate</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">log_frequency</span> <span class="o">=</span> <span class="mi">10</span>

<span class="p">[</span><span class="n">output</span><span class="p">]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">outdata</span><span class="o">/</span><span class="n">stress</span><span class="o">.</span><span class="n">dat</span>
<span class="n">decomp</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="mi">10000</span>
</pre></div>
</div>
<section id="input">
<h4>[input]<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h4>
<p>In this section, we specify the input file format.</p>
<dl class="simple">
<dt>format = amber</dt><dd><p>CURP reads the input files in the Amber format.</p>
</dd>
<dt>first_last_interval = 1 200 1</dt><dd><p>Three numbers, &lt;first&gt;, &lt;last&gt;, and &lt;interval&gt; are given in this order, to specify that CURP will read the MD frames from the &lt;first&gt; to the &lt;last&gt; position at intervals of &lt;interval&gt; frames.</p>
</dd>
<dt>group_file = group.ndx</dt><dd><p>Specifies the name of the ‘group definition file’. Each group is defined as a list of atoms. A group could be either a residue or an arbitrary set of atoms.</p>
</dd>
</dl>
</section>
<section id="input-amber">
<h4>[input_amber]<a class="headerlink" href="#input-amber" title="Permalink to this headline">¶</a></h4>
<p>This section name depends on the <cite>format</cite> keyword specified in the <code class="docutils literal notranslate"><span class="pre">[input]</span></code> section. The name of this section is <cite>[input_amber]</cite> because the <cite>format</cite> keyword in the <code class="docutils literal notranslate"><span class="pre">[input]</span></code> section is “amber”.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">[input_amber]</span></code> section, the following parameters must be specified.</p>
<dl class="simple">
<dt>target = trajectory | restart</dt><dd><p>If <cite>trajectory</cite> is specified, CURP assumes that the input files are trajectory files.</p>
</dd>
<dt>topology_file = ../system.prmtop</dt><dd><p>Parameter and topology file.</p>
</dd>
<dt>coordinate_format = ascii | netcdf</dt><dd><p>Format of the trajectory files.</p>
</dd>
<dt>coordinate_file = &lt;mdcrd_file&gt;</dt><dd><p>The name of the coordinates trajectory file.</p>
</dd>
<dt>velocity_format = ascii | netcdf</dt><dd><p>Format of the velocity trajectory files.</p>
</dd>
<dt>velocity_file = &lt;mdvel_file&gt;</dt><dd><p>The name of the velocity trajectory file.</p>
</dd>
</dl>
</section>
<section id="curp">
<h4>[curp]<a class="headerlink" href="#curp" title="Permalink to this headline">¶</a></h4>
<p>In this section, we set the parameters for the calculations of pairwise interatomic forces.</p>
<dl class="simple">
<dt>potential = amberbase | amber94 | amber96 | amber99 | amber99SB | amber03 | amber12SB</dt><dd><p>Type of force-field functions.</p>
</dd>
<dt>method = momentum-current | energy-flux | heat-flux</dt><dd><p><cite>momentum-current</cite>: Atomic stress tensors analysis.
<cite>energy-flux</cite>: Interatomic energy flow analysis.
<cite>heat-flux</cite>: Interatomic heat flow analysis.</p>
</dd>
<dt>group_method = none | united | residue | file</dt><dd><p>Unit of atom groups.
<code class="docutils literal notranslate"><span class="pre">none</span></code>: No groups are defined.
<code class="docutils literal notranslate"><span class="pre">united</span></code>: Each heavy atom, either polar or nonpolar, represents a united atom “group” and all hydrogen atoms attached to the heavy atom  belong to the “group”.
<code class="docutils literal notranslate"><span class="pre">residue</span></code>: Groups are defined by residues unit.
<code class="docutils literal notranslate"><span class="pre">file</span></code>: Groups are defined by the file specified by the <code class="docutils literal notranslate"><span class="pre">group_file</span></code> keyword in the input section.</p>
</dd>
<dt>target_atoms = 1-33</dt><dd><p>The target region for the analysis.
In this case, atomic stress tensors are calculated for the 1st to the 33rd atoms.</p>
</dd>
<dt>remove_trans = yes | no</dt><dd><p>Translational motions are removed from the trajectory, if this keyword is set to “yes” (strongly recommended).</p>
</dd>
<dt>remove_rotate = yes | no</dt><dd><p>Rotational motions are removed form the trajectory, if this keyword is set to “yes” (strongly recommended).</p>
</dd>
<dt>log_frequency = 10</dt><dd><p>Print results to stdout every log_frequency steps.</p>
</dd>
</dl>
</section>
<section id="volume">
<h4>[volume]<a class="headerlink" href="#volume" title="Permalink to this headline">¶</a></h4>
<p>For the atomic stress tensor analysis, CURP performs Voronoi tessellation
to calculate the atomic volumes.</p>
<dl>
<dt>method = voronoi | none | vdw | outer</dt><dd><p><code class="docutils literal notranslate"><span class="pre">voronoi</span></code>: Atomic volume calculations are performed by Voronoi tesselation.
See <cite>Specification of curp setting file</cite> in the reference section for other values.
We coded a Fortran90 program for the atomic volume calculation based on Voronoi
tesselation algorithm found in the literature (“Computer Simulation of Liquids”,
M.P. Allen and D.J. Tildesley eds., Oxford Univ. Press (1987)).</p>
</dd>
<dt>output_volume_file = &lt;file_path&gt;</dt><dd><p>The path to the output file for the atomic volumes.</p>
</dd>
<dt>output_gvolume_file = &lt;file_path&gt;</dt><dd><p>The path to the output file for the group volumes.</p>
</dd>
<dt>voronoi_cutoff = 6.0</dt><dd><p>The cutoff length for the neighbor candidate search in voronoi tessellation.</p>
</dd>
<dt>voronoi_no_hydrogen = yes | no</dt><dd><p>Treatment of the hydrogen atoms in Voronoi tessellation.
If this option is “yes”, then the hydrogen atoms are neglected for the Voronoi tessellation and the evaluation of the group stress tensors, even when a hydrogen atom is included in the target for the calculation in the [curp] section. Within the program, in this case, the atomic volume of a hydrogen atom is set to be 8.0 Å <sup>3</sup> to avoid division by zero for convenience.</p>
</dd>
<dt>voronoi_solvation = RANDOM20 | none</dt><dd><p>For atoms exposed on the surface of a target protein molecule
in vacuum, it is not possible to define the Volonoi polyhedron.</p>
<p><cite>RANDOM20</cite>: To avoid this problem, the protein molecule is placed
in a hydration sphere (radius = 20 Å) of randomly generated
non-overlapping water molecules. If your target system is so large
that the hydration sphere is not able to cover the system, plase use
the <cite>none</cite> option and solvate the system with a sufficiently large number of
hydration layers. (see below)</p>
<p><cite>none</cite>: This keyword is specified when CURP performes the stress
tensor analysis for the system including explicit solvent layers.</p>
</dd>
<dt>voronoi_probe_length = 2.8</dt><dd><p>The probe length [Å] of the solvation for the Voronoi method.
If voronoi_solvation is set, CURP removes water molecules within
&lt;voronoi_prove_length&gt; [Å] from all atom of the system.</p>
</dd>
</dl>
</section>
<section id="output">
<h4>[output]<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h4>
<p>Output format specification.</p>
<dl>
<dt>filename = outdata/stress.dat</dt><dd><p>Specify the naming convention of the datafile for the stress tensor analysis.
In this example, the file name is <cite>outdata/stress_grp.dat00001</cite>,
<cite>outdata/stress_grp.dat00002</cite> , … and so on.</p>
<p>Please note that the datafile is generated for each force component if <cite>decomp = yes</cite>. (see below)</p>
</dd>
<dt>frequency = 10000</dt><dd><p>The number of frames output to a single datafile. It is highly recommended to estimate the file size of a single datafile in advance.</p>
</dd>
<dt>decomp = no | yes</dt><dd><p>If “yes”, stress tensors are separated into different components.</p>
</dd>
</dl>
</section>
</section>
<section id="setting-group-ndx">
<h3>Setting group.ndx<a class="headerlink" href="#setting-group-ndx" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above, the user can define any group of atoms for the
stress tensor analysis. When the <cite>group_method</cite> keyword is set to be
<cite>file</cite> in the [curp] section, and <cite>group_file</cite> name is specified in the
[input] section, user defined grouping is applied.</p>
<p>In the following example, stress tensor analysis is performed separately
for the main chain parts and for the side chain parts.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">01</span><span class="n">_ALA_M</span><span class="p">]</span>
<span class="mi">1</span><span class="o">-</span><span class="mi">6</span> <span class="mi">11</span><span class="o">-</span><span class="mi">12</span>

<span class="p">[</span><span class="mi">01</span><span class="n">_ALA_S</span><span class="p">]</span>
<span class="mi">7</span><span class="o">-</span><span class="mi">10</span>

<span class="p">[</span><span class="mi">02</span><span class="n">_ALA_M</span><span class="p">]</span>
<span class="mi">13</span><span class="o">-</span><span class="mi">16</span> <span class="mi">21</span><span class="o">-</span><span class="mi">22</span>

<span class="p">[</span><span class="mi">02</span><span class="n">_ALA_S</span><span class="p">]</span>
<span class="mi">17</span><span class="o">-</span><span class="mi">20</span>

<span class="p">[</span><span class="mi">03</span><span class="n">_ALA_M</span><span class="p">]</span>
<span class="mi">23</span><span class="o">-</span><span class="mi">26</span> <span class="mi">31</span><span class="o">-</span><span class="mi">33</span>

<span class="p">[</span><span class="mi">03</span><span class="n">_ALA_S</span><span class="p">]</span>
<span class="mi">27</span><span class="o">-</span><span class="mi">30</span>
</pre></div>
</div>
<p>Here, each group name is surrounded by <cite>[</cite> and <cite>]</cite>.
Then the list of the individual atoms is given in which each atom is separated
by a space, tab or a blank line. Alternatively, a range of atoms can
be indicated by using <cite>-</cite>.</p>
</section>
<section id="output-files">
<h3>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h3>
<section id="stress-tensor-data-file">
<h4>stress tensor data file<a class="headerlink" href="#stress-tensor-data-file" title="Permalink to this headline">¶</a></h4>
<p>For each snapshot of the MD trajectory, 3x3 stress tensors are output to
<cite>outdata/stress_grp.dat00000</cite>. An example is shown below:</p>
<img alt="../_images/stress_grp.png" class="align-center" src="../_images/stress_grp.png" />
<p>Comment lines begin with <code class="docutils literal notranslate"><span class="pre">%</span></code>.
For each time frame, nine elements (xx, xy, xz, yx, yy, yz, zx, zy, zz) are printed for each group.</p>
</section>
<section id="voluemes-dat-gvoluems-dat">
<h4>voluemes.dat, gvoluems.dat<a class="headerlink" href="#voluemes-dat-gvoluems-dat" title="Permalink to this headline">¶</a></h4>
<p>Atomic volumes and group volumes are printed to the files
specified by the <cite>output_volume_file</cite> and
<cite>output_gvolume_file</cite> keywards in the [volume] section.
If no file names are specified, no data is printed.</p>
</section>
</section>
</section>
<section id="analysis-of-stress-tensor">
<h2><a class="toc-backref" href="#id3"><span class="section-number">3.2.3. </span>Analysis of stress tensor</a><a class="headerlink" href="#analysis-of-stress-tensor" title="Permalink to this headline">¶</a></h2>
<p>The direct output of the stress tensor analysis itself is inconvenient for
two reasons: (1) the output file contains a large amount of data
of the time-series of the MD trajectory and (2) the stress tensor has 3x3=9
components.</p>
<p>To simplify the analysis,
we show how to diagonalize and time average the stress tensor as follows:</p>
<p>Time-averaging:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}_{J} = \left\langle
   {\frac{1}{{{\Omega _J}}}\sum\limits_{i \in J} {\left( {\frac{1}{2}\sum\limits_{k \ne i} {{{\boldsymbol{F}}_{{\boldsymbol{ik}}}} \otimes {{\boldsymbol{r}}_{{\boldsymbol{ik}}}}} }
   \right)} } \right\rangle\]</div>
<p>Diagonalization:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{\sigma '} = \begin{pmatrix}
   \sigma _{x'x'}&amp;0&amp;0 \\
   0&amp;\sigma _{y'y'}&amp;0 \\
    0&amp;0&amp;\sigma _{z'z'}
\end{pmatrix}\end{split}\]</div>
<p>Root-mean-square amplitude of the diagonal components:</p>
<div class="math notranslate nohighlight">
\[\bar{\sigma '} =
   \sqrt {\sigma _{x'x'}^2 + \sigma _{y'y'}^2 + \sigma _{z'z'}^2}\]</div>
<p>The last quantity is used to measure the magnitude of the stress tensor.</p>
<p>These calculations are performed by the <cite>ana.sh</cite> script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./ana.sh
</pre></div>
</div>
<p><cite>ana.sh</cite> uses  <cite>curp script simplify-tensor</cite>,</p>
<section id="result">
<h3>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h3>
<p>Finally, a detailed summary of the calculated data is output to <cite>grp-sim.dat</cite>.</p>
<img alt="../_images/grp-sim.png" class="align-center" src="../_images/grp-sim.png" />
<p>Examination of these results reveals the following characteristic features:</p>
<ul class="simple">
<li><p>The improper and torsion componets show relatively large values.</p></li>
<li><p>Main chain carbonyl carbons show particularly large values for two reasons:
(1) They are involved in the two improper torsions, C-O-Cα-N and N-H-C-Cα.
(2) Their atomic volume is small because of the tight packing by the nearby atoms.</p></li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">3.2. Atomic stress tensor analysis</a><ul>
<li><a class="reference internal" href="#obtaining-the-md-trajectory">3.2.1. Obtaining the MD trajectory</a></li>
<li><a class="reference internal" href="#stress-tensor-calculation">3.2.2. Stress tensor calculation</a><ul>
<li><a class="reference internal" href="#running-the-program">Running the program</a></li>
<li><a class="reference internal" href="#setting-run-cfg">Setting run.cfg</a><ul>
<li><a class="reference internal" href="#input">[input]</a></li>
<li><a class="reference internal" href="#input-amber">[input_amber]</a></li>
<li><a class="reference internal" href="#curp">[curp]</a></li>
<li><a class="reference internal" href="#volume">[volume]</a></li>
<li><a class="reference internal" href="#output">[output]</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-group-ndx">Setting group.ndx</a></li>
<li><a class="reference internal" href="#output-files">Output files</a><ul>
<li><a class="reference internal" href="#stress-tensor-data-file">stress tensor data file</a></li>
<li><a class="reference internal" href="#voluemes-dat-gvoluems-dat">voluemes.dat, gvoluems.dat</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#analysis-of-stress-tensor">3.2.3. Analysis of stress tensor</a><ul>
<li><a class="reference internal" href="#result">Result</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../general_tutorial/"
                          title="previous chapter"><span class="section-number">3.1. </span>General instructions</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../eflow_tutorial/"
                          title="next chapter"><span class="section-number">3.3. </span>Energy flow analysis</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/stress_tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../eflow_tutorial/" title="3.3. Energy flow analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="../general_tutorial/" title="3.1. General instructions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../">CURP 1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../tutorials/" ><span class="section-number">3. </span>Tutorials</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.2. </span>Atomic stress tensor analysis</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2022, Yamato Labaratory.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>